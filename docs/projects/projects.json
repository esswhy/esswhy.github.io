[
  {
    "path": "projects/pca_usda_food/",
    "title": "Principal Component Analysis: USDA Food Nutrient Information",
    "description": "In this project, I used principal component analysis to explore macronutrient and micronutrient information for various food groups listed by the United States Department of Agriculture.",
    "author": [
      {
        "name": "Shuying Yu",
        "url": {}
      }
    ],
    "date": "2022-02-12",
    "categories": [
      "Principal Component Analysis",
      "R"
    ],
    "contents": "\r\n\r\nContents\r\nIntroduction\r\nResearch Question\r\nData and Methods\r\nResults\r\nMinerals\r\nPrincipal Component Analysis\r\nScree Plot\r\nLoadings\r\n\r\nVitamins\r\nPrincipal Component Analysis\r\nScree Plot\r\nLoadings\r\n\r\n\r\nSummary\r\nReferences\r\nData and Literature\r\nR Libraries\r\n\r\n\r\n\r\n\r\nCode\r\n\r\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message= FALSE,\r\n                      fig.align = \"center\")\r\n\r\n#Attach libraries\r\nlibrary(tidyverse)\r\nlibrary(here)\r\nlibrary(janitor)\r\nlibrary(ggfortify) \r\nlibrary(RColorBrewer)\r\nlibrary(kableExtra)\r\n\r\n\r\n\r\nIntroduction\r\nIn this project, I used principal component analysis to explore macronutrient and micronutrient information for various food groups from the United States Department of Agriculture’s (USDA) National Nutrient Database or FoodData Central. Principal component analysis (PCA) was conducted on both mineral and vitamin nutrients, and their scree plots and loadings were visualized to assess the amount of variance explained.\r\nResearch Question\r\nCan we use PCA to reduce the number dimensions of the multivariate dataset in order to find clusters or groups of observations and also visually explore interesting relationships between different food groups? Using different nutrients such as minerals and vitamins, can we observe any patterns in the observations or correlations between the variables?\r\nData and Methods\r\nDifferent types of food contain varying levels of macronutrients (protein, fat, carbohydrates) and micronutrients (vitamins and minerals). Food groups were chosen based on their different levels of nutrients and energy (calories) (NIH NIA Know Your Food Groups, Accessed 02/18/2022) that would allow for interesting relationships and correlations between them. One of the food groups I selected was fruits and fruit juices because fruits tend to be low in calories and fat, but may be higher in vitamins, fiber, and carbohydrates. Animal products such as beef, shellfish, and dairy and egg products were chosen because they tend to be higher in calories with higher levels of protein and minerals. Legumes and grains are also high in protein, but may contain lower in calories. As for cereals and grains, they contain a high amount of calories but also high levels of minerals, vitamins, and fiber. Lastly, I chose sweets and fats because they are high in calories, but contain the lowest levels of micronutrients. For macronutrients, “carbohydrates” include unprocessed, minimally processed, and processed starches and natural sugars, whereas “sugar” refers to nutritive and nonutritive sweeteners (e.g., added granulated sugar) (USDA National Agricultural Library, Accessed 02/18/2022). The data is publicly available through the United States Department of Agriculture’s (USDA) National Nutrient Database (USDA FoodData Central, Accessed 02/14/2022).\r\nPCA will be conducted for vitamins and minerals separately to prevent overcrowding of biplots. Data were scaled and biplots were created to visually epxlore relationships between food groups and vitamins or minerals. Scree plots were also created to visualize proportion of variance explained by each principal component. All analyses were conducted in R version 4.1.1 and RStudio version 1.4.1717.\r\nResults\r\nMinerals\r\nPrincipal Component Analysis\r\nFor this PCA, I included the following variables:\r\nenergy or calories (kcal), fiber (g), sugar (g)\r\ncarbohydrate (g), protein (g), fat (g)\r\ncalcium (mg), copper (mcg), iron (mg), magnesium (mg), manganese (mg), phosphorous (g), selenium (mcg), zinc (mg)\r\n\r\n\r\nCode\r\n\r\n########## Read in the data ##########\r\n\r\nfood <- read_csv(here(\"_projects\", \"data\", \"usda_nutrients.csv\")) %>% \r\n  \r\n  #Convert variable names to lower case\r\n  clean_names()\r\n\r\n\r\n\r\n########## Subset data for common minerals ##########\r\n\r\nfood_minerals <- food %>% \r\n  \r\n  #Select certain nutrients: calories, macros, and minerals \r\n  select(food_group, short_descrip, \r\n         energy_kcal:fiber_g,\r\n         calcium_mg:zinc_mg) %>% \r\n  \r\n  #Drop missing values\r\n  drop_na() %>% \r\n  \r\n  #Filter food groups: fruits/veggies, grains/legumes, meats/dairy, fats\r\n  filter(food_group %in% c(\"Fruits and Fruit Juices\",\r\n                           \"Cereal Grains and Pasta\", \"Legumes and Legume Products\",\r\n                           \"Dairy and Egg Products\", \"Finfish and Shellfish Products\",\r\n                           \"Beef Products\", \"Sweets\", \"Fats and Oils\"))\r\n\r\n\r\n\r\n########## PCA ##########\r\n\r\nfood_pca <- food_minerals %>% \r\n  \r\n  #Remove factors or strings\r\n  select(-c(food_group,short_descrip)) %>% \r\n  \r\n  #Scale numeric data\r\n  scale() %>% \r\n  \r\n  #Perform PCA\r\n  prcomp\r\n\r\n\r\n#Save loadings into dataframe\r\nloadings_df <- data.frame(food_pca$rotation) %>%\r\n  mutate(axis = row.names(.))\r\n\r\n#Save components into new axis\r\nnew_pts_df <- data.frame(food_pca$x)\r\n\r\n\r\n\r\n########## Biplot ##########\r\n\r\n#Autoplot using ggfortify\r\n#Use ggplot \r\nautoplot(food_pca,\r\n         \r\n         #Associate df with PCA df\r\n         data = food_minerals,\r\n         \r\n         #Show loadings\r\n         loadings = TRUE,\r\n         \r\n         #Color by food group\r\n         #Need UK spelling\r\n         colour = \"food_group\",\r\n         \r\n         #Show PC1 and PC2 label\r\n         loadings.label = TRUE,\r\n         \r\n         #Change color of PC arrows\r\n         loadings.colour = \"cyan2\",\r\n         \r\n         #Change color of PC labels\r\n         loadings.label.colour = \"black\",\r\n         \r\n         #Change position of labels\r\n         loadings.label.vjust = -0.5) +\r\n  \r\n  #Change legend title\r\n  labs(color = \"Food Group\") +\r\n\r\n  #Change color of points\r\n  scale_color_brewer(type = \"qual\", palette = \"Set2\") +\r\n  \r\n  #Change theme\r\n  theme_minimal() +\r\n  \r\n  #Move legend title to top\r\n  guides(color = guide_legend(title.position = \"top\")) +\r\n  \r\n  #Add custom theme\r\n  #Change legend position\r\n  theme(legend.position = \"top\",\r\n        \r\n        #Change width of legend\r\n        legend.key.width = unit(0.06, 'cm'),\r\n        \r\n        #Bold and change legend title\r\n        legend.title = element_text(face = \"bold\", size = 11),\r\n        \r\n        #Bold and change size of axes labels\r\n        axis.title = element_text(face = \"bold\", size = 11),\r\n        \r\n        #Change size of ticks\r\n        axis.text = element_text(size = 10))\r\n\r\n\r\n\r\n\r\nFigure 1. Biplot of the principal component analysis for macronutrients, energy, fiber, and minerals. All variables are scaled. Arrows (cyan) indicate the loading (eigenvalues) of variables for the first two principal components (PC), such that the length represents increasing variance in the direction of the PC. The text labels (black) represent the eigenvalue labels. Points represent individual observations belonging to specific food groups (colored), which are plotted along the first two PCs. The x-axis and y-axis show the proportion of variance explained by the first and second PC, respectively. Data source: USDA FoodData Central (Accessed 02/14/2022).\r\n\r\nFrom the PCA for minerals, we can observe the following patterns from the biplot (Figure 1):\r\nMost minerals are on the positive side of the first principal component (PC), whereas calories, fat, sugar, and carbohydrates are on the negative side. This indicates that the first PC may differentiate between macronutrients and micronutrients (minerals).\r\nFoods high in protein are on the positive side of the second PC, whereas all other nutrient variables are on the negative side. This indicates that the second PC may differentiate between foods categorized as animal or non-animal products.\r\nFoods with higher amounts of protein tend to have lower levels of sugar and fat, but higher levels of zinc and selenium mineral, and foods with higher calories or energy tend to have higher levels of carbohydrates. Fiber is not correlated with macronutrients or minerals, but most minerals such as calcium, magnesium, and copper are positively correlated with each other\r\nScree Plot\r\n\r\n\r\nCode\r\n\r\n#Standard deviation vector\r\nsd_vec <- food_pca$sdev\r\n\r\n#Variance vector\r\nvar_vec <- sd_vec^2\r\n\r\n#Vector of PC names\r\npc_names <- colnames(food_pca$rotation)\r\n\r\n#Percent explained df\r\npct_expl_df <- data.frame(v = var_vec,\r\n                          \r\n                          #Each value divided by sum of variance\r\n                          pct_v = var_vec/sum(var_vec),\r\n                          \r\n                          #Labels\r\n                          pc = fct_inorder(pc_names)) %>% \r\n  \r\n  mutate(pct_lbl = paste0(round(pct_v*100, 1), '%'))\r\n\r\n\r\n\r\n#Plot\r\nggplot(data = pct_expl_df, aes(x = pc, y = v)) +\r\n  \r\n  #Column\r\n  geom_col(fill = \"cyan4\") +\r\n  \r\n  #Add label\r\n  geom_text(aes(label = pct_lbl),\r\n            vjust = 0, nudge_y = 0.05) +\r\n  \r\n  #Change theme\r\n  theme_minimal() +\r\n  \r\n  #Change x-axis and y-axis labels\r\n  labs(x = \"Principal Component\",\r\n       y = \"Eigenvalue\") +\r\n  \r\n  #Add custom theme\r\n  #Bold and change size of axes labels\r\n  theme(axis.title = element_text(face = \"bold\", size = 11),\r\n        \r\n        #Change size of ticks\r\n        axis.text = element_text(size = 10))\r\n\r\n\r\n\r\n\r\nFigure 2. Scree plot for the principal component analysis exploring macronutrients, energy, fiber, and minerals for various food groups. The x-axis represents the specific principal component (PC) and the y-axis represents the eigenvalue. The black text above each bar in the plot represents the proportion of variance explained by that PC. Data source: USDA FoodData Central (Accessed 02/14/2022).\r\n\r\nLoadings\r\n\r\n\r\nCode\r\n\r\n#Loadings or rotations of first 4 PCs\r\nfood_pca_table <- as.data.frame(food_pca$rotation[,1:4])\r\n\r\n\r\n\r\n#Present as table\r\nfood_pca_table %>% \r\n\r\n  #Add table caption\r\n  kable(caption = \"Loadings or rotations for the first four principal components (PC) for the principal component analysis for macronutrients, energy, fiber, and minerals. Data source: USDA FoodData Central (Accessed 02/14/2022).\",\r\n        \r\n        #Round digits\r\n        digits = 2,\r\n        \r\n        #Align PCs to center\r\n        align = rep(\"c\", times = 5),\r\n        \r\n        #Change width of table\r\n        table.attr = \"style='width:70%;'\") %>% \r\n  \r\n  #kableExtra styling\r\n  #Not make table full width, hover rows\r\n  kable_styling(bootstrap_options = \"hover\") %>% \r\n  \r\n  #Bold row names\r\n  column_spec(1, bold = TRUE) %>% \r\n  \r\n  #Highlight specific cells for high negative and positive values\r\n  #Color text white if background is hightlighted\r\n\r\n  #PC1\r\n  column_spec(2, background = case_when(food_pca_table$PC1 <= -0.25 ~ \"firebrick\", \r\n                                        food_pca_table$PC1 >= 0.30 ~ \"darkgreen\",\r\n                                        TRUE ~ \" \"),\r\n              color = case_when(food_pca_table$PC1 <= -0.25 ~ \"white\", \r\n                                food_pca_table$PC1 >= 0.30 ~ \"white\",\r\n                                TRUE ~ \" \")) %>% \r\n  #PC2\r\n  column_spec(3, background = case_when(food_pca_table$PC2 <= -0.25 ~ \"firebrick\", \r\n                                        food_pca_table$PC2 >= 0.30 ~ \"darkgreen\",\r\n                                        TRUE ~ \" \"),\r\n              color = case_when(food_pca_table$PC2 <= -0.25 ~ \"white\", \r\n                                food_pca_table$PC2 >= 0.30 ~ \"white\",\r\n                                TRUE ~ \" \")) %>% \r\n  #PC3\r\n  column_spec(4, background = case_when(food_pca_table$PC3 <= -0.25 ~ \"firebrick\", \r\n                                        food_pca_table$PC3 >= 0.30 ~ \"darkgreen\",\r\n                                        TRUE ~ \" \"),\r\n              color = case_when(food_pca_table$PC3 <= -0.25 ~ \"white\", \r\n                                food_pca_table$PC3 >= 0.30 ~ \"white\",\r\n                                TRUE ~ \" \")) %>%\r\n\r\n  #PC4\r\n  column_spec(5, background = case_when(food_pca_table$PC4 <= -0.25 ~ \"firebrick\", \r\n                                        food_pca_table$PC4 >= 0.30 ~ \"darkgreen\",\r\n                                        TRUE ~ \" \"),\r\n              color = case_when(food_pca_table$PC4 <= -0.25 ~ \"white\", \r\n                                food_pca_table$PC4 >= 0.30 ~ \"white\",\r\n                                TRUE ~ \" \"))\r\n\r\n\r\n\r\nTable 1: Loadings or rotations for the first four principal components (PC) for the principal component analysis for macronutrients, energy, fiber, and minerals. Data source: USDA FoodData Central (Accessed 02/14/2022).\r\n\r\n\r\n\r\n\r\nPC1\r\n\r\n\r\nPC2\r\n\r\n\r\nPC3\r\n\r\n\r\nPC4\r\n\r\n\r\nenergy_kcal\r\n\r\n\r\n-0.05\r\n\r\n\r\n-0.25\r\n\r\n\r\n-0.65\r\n\r\n\r\n0.00\r\n\r\n\r\nprotein_g\r\n\r\n\r\n0.43\r\n\r\n\r\n0.20\r\n\r\n\r\n-0.07\r\n\r\n\r\n0.12\r\n\r\n\r\nfat_g\r\n\r\n\r\n-0.11\r\n\r\n\r\n-0.04\r\n\r\n\r\n-0.71\r\n\r\n\r\n-0.08\r\n\r\n\r\ncarb_g\r\n\r\n\r\n-0.10\r\n\r\n\r\n-0.52\r\n\r\n\r\n0.17\r\n\r\n\r\n0.08\r\n\r\n\r\nsugar_g\r\n\r\n\r\n-0.20\r\n\r\n\r\n-0.36\r\n\r\n\r\n0.11\r\n\r\n\r\n0.19\r\n\r\n\r\nfiber_g\r\n\r\n\r\n0.13\r\n\r\n\r\n-0.43\r\n\r\n\r\n0.11\r\n\r\n\r\n-0.14\r\n\r\n\r\ncalcium_mg\r\n\r\n\r\n0.13\r\n\r\n\r\n-0.13\r\n\r\n\r\n-0.07\r\n\r\n\r\n0.65\r\n\r\n\r\ncopper_mcg\r\n\r\n\r\n0.26\r\n\r\n\r\n-0.22\r\n\r\n\r\n0.00\r\n\r\n\r\n-0.38\r\n\r\n\r\niron_mg\r\n\r\n\r\n0.38\r\n\r\n\r\n-0.16\r\n\r\n\r\n0.00\r\n\r\n\r\n-0.21\r\n\r\n\r\nmagnesium_mg\r\n\r\n\r\n0.33\r\n\r\n\r\n-0.37\r\n\r\n\r\n0.00\r\n\r\n\r\n-0.02\r\n\r\n\r\nmanganese_mg\r\n\r\n\r\n0.07\r\n\r\n\r\n-0.08\r\n\r\n\r\n0.02\r\n\r\n\r\n-0.35\r\n\r\n\r\nphosphorus_mg\r\n\r\n\r\n0.41\r\n\r\n\r\n-0.09\r\n\r\n\r\n-0.05\r\n\r\n\r\n0.39\r\n\r\n\r\nselenium_mcg\r\n\r\n\r\n0.35\r\n\r\n\r\n0.24\r\n\r\n\r\n-0.03\r\n\r\n\r\n0.07\r\n\r\n\r\nzinc_mg\r\n\r\n\r\n0.31\r\n\r\n\r\n0.14\r\n\r\n\r\n-0.06\r\n\r\n\r\n-0.18\r\n\r\n\r\nThe first two PCs of the PCA that includes minerals explain about 41.6% of the variance (Figure 2), while the first four PCs explain about 64.05% variance.\r\nSimilar to what was shown in the biplot (Figure 1), the first PC has high positive loadings (\\(\\ge 0.30\\)) for protein and various minerals (Table 1), suggesting this PC may capture information about food groups that contain animal products such as beef and shellfish. The second PC has high negative loadings (\\(\\le -0.25\\)) for carbohydrates, sugars, and fibers, and this could mean this PC captures information about foods that contain grains or cereals. The third PC has high negative loadings for energy and fat, which possibly represents the food group for fats and oils. The fourth PC shows high positive loadings for calcium and phosphorous but high negative loadings for copper and manganese, suggesting that foods with high calcium and phosphorous tend to be foods with lower amounts of copper and manganese.\r\nVitamins\r\nPrincipal Component Analysis\r\nFor this PCA, I included the following variables:\r\nenergy or calories (kcal), fiber (g), sugar (g)\r\ncarbohydrate (g), protein (g), fat (g)\r\nvitamin A (mcg), vitamin B6 (mg), vitamin B12 (mcg), vitamin C (mg), vitamin E (mg), folate (mcg), niacin (mg), riboflavin (mg), thiamin (mg)\r\n\r\n\r\nCode\r\n\r\n########## Subset data for common vitamins ##########\r\n\r\nfood_vitamins <- food %>% \r\n  \r\n  #Select certain nutrients: calories, macros, and vitamins \r\n  select(food_group, short_descrip, energy_kcal:fiber_g,\r\n         vit_a_mcg:thiamin_mg) %>% \r\n  \r\n  #Drop missing values\r\n  drop_na() %>% \r\n  \r\n  #Filter food groups: fruits/veggies, grains/legumes, meats/dairy, fats\r\n  filter(food_group %in% c(\"Fruits and Fruit Juices\",\r\n                           \"Cereal Grains and Pasta\", \"Legumes and Legume Products\",\r\n                           \"Dairy and Egg Products\", \"Finfish and Shellfish Products\",\r\n                           \"Beef Products\", \"Sweets\", \"Fats and Oils\"))\r\n\r\n\r\n\r\n########## PCA ##########\r\n\r\nfood_pca2 <- food_vitamins %>% \r\n  \r\n  #Remove factors or strings\r\n  select(-c(food_group,short_descrip)) %>% \r\n  \r\n  #Scale numeric data\r\n  scale() %>% \r\n  \r\n  #Perform PCA\r\n  prcomp\r\n\r\n\r\n#Save loadings into dataframe\r\nloadings_df2 <- data.frame(food_pca2$rotation) %>%\r\n  mutate(axis = row.names(.))\r\n\r\n#Save components into new axis\r\nnew_pts_df2 <- data.frame(food_pca2$x)\r\n\r\n\r\n\r\n########## Biplot ##########\r\n\r\n#Autoplot using ggfortify\r\n#Use ggplot \r\nautoplot(food_pca2,\r\n         \r\n         #Associate df with PCA df\r\n         data = food_vitamins,\r\n         \r\n         #Show loadings\r\n         loadings = TRUE,\r\n         \r\n         #Color by food group\r\n         #Need UK spelling\r\n         colour = \"food_group\",\r\n         \r\n         #Show PC1 and PC2 label\r\n         loadings.label = TRUE,\r\n         \r\n         #Change color of PC arrows\r\n         loadings.colour = \"cyan2\",\r\n         \r\n         #Change label color\r\n         loadings.label.colour = \"black\",\r\n         \r\n         #Change position of labels\r\n         loadings.label.vjust = -1) +\r\n  \r\n  #Change legend title\r\n  labs(color = \"Food Group\") +\r\n  \r\n  #Change color of points\r\n  scale_color_brewer(type = \"qual\", palette = \"Set2\") +\r\n  \r\n  #Change theme\r\n  theme_minimal() +\r\n  \r\n  #Move legend title to top\r\n  guides(color = guide_legend(title.position = \"top\")) +\r\n  \r\n  #Add custom theme\r\n  #Change legend position\r\n  theme(legend.position = \"top\",\r\n        \r\n        #Change width of legend\r\n        legend.key.width = unit(0.07, 'cm'),\r\n        \r\n        #Bold and change legend title\r\n        legend.title = element_text(face = \"bold\", size = 11),\r\n        \r\n        #Bold and change size of axes labels\r\n        axis.title = element_text(face = \"bold\", size = 11),\r\n        \r\n        #Change size of ticks\r\n        axis.text = element_text(size = 10))\r\n\r\n\r\n\r\n\r\nFigure 3. Biplot of the principal component analysis for macronutrients, energy, fiber, and vitamins. All variables are scaled. Arrows (cyan) indicate the loading (eigenvalues) of variables for the first two principal components (PC), such that the length represents increasing variance in the direction of the PC. The text labels (black) represent the eigenvalue labels. Points represent individual observations belonging to specific food groups (colored), which are plotted along the first two PCs. The x-axis and y-axis show the proportion of variance explained by the first and second PC, respectively. Data source: USDA FoodData Central (Accessed 02/14/2022).\r\n\r\nFrom the PCA for vitamins, we can observe the following patterns from the biplot (Figure 3):\r\nMost vitamins are on the positive side of the first PC, whereas sugar and carbohydrates are on the negative side. This indicates that the first PC may differentiate between sweet foods and foods with more nutrients.\r\nFoods high in fat, vitamine E, and energy or calories are on the positive side of the second PC, whereas other macronutrients (sugar and carbohydrates) are on the negative side. This indicates that the second PC may differentiate between foods that are high in fat and oil versus other foods.\r\nThe bipolot shows three distinct groupings (foods high in fat, sugar and carbohydrates, and vitamins). Vitamins are generally all positively correlated with one another, and foods high in sugar tend to also be high in carbohydrates. Foods with high levels of fat and energy are positively correlated with foods with high levels of vitamin E. Foods high in vitamin C and fiber also tend to be positively correlated.\r\nScree Plot\r\n\r\n\r\nCode\r\n\r\n#Standard deviation vector\r\nsd_vec2 <- food_pca2$sdev\r\n\r\n#Variance vector\r\nvar_vec2 <- sd_vec2^2\r\n\r\n#Vector of PC names\r\npc_names2 <- colnames(food_pca2$rotation)\r\n\r\n#Percent explained df\r\npct_expl_df2 <- data.frame(v = var_vec2,\r\n                          \r\n                          #Each value divided by sum of variance\r\n                          pct_v = var_vec2/sum(var_vec2),\r\n                          \r\n                          #Labels\r\n                          pc = fct_inorder(pc_names2)) %>% \r\n  \r\n  mutate(pct_lbl = paste0(round(pct_v*100, 1), '%'))\r\n\r\n\r\n\r\n#Plot\r\nggplot(data = pct_expl_df2, aes(x = pc, y = v)) +\r\n  \r\n  #Column\r\n  geom_col(fill = \"cyan4\") +\r\n  \r\n  #Add label\r\n  geom_text(aes(label = pct_lbl),\r\n            vjust = 0, nudge_y = 0.05) +\r\n  \r\n  #Change theme\r\n  theme_minimal() +\r\n  \r\n  #Change x-axis and y-axis labels\r\n  labs(x = \"Principal Component\",\r\n       y = \"Eigenvalue\") +\r\n  \r\n  #Add custom theme\r\n  #Bold and change size of axes labels\r\n  theme(axis.title = element_text(face = \"bold\", size = 11),\r\n        \r\n        #Change size of ticks\r\n        axis.text = element_text(size = 10))\r\n\r\n\r\n\r\n\r\nFigure 4. Scree plot for the principal component analysis exploring macronutrients, energy, fiber, and vitamins for various food groups. The x-axis represents the specific principal component (PC) and the y-axis represents the eigenvalue. The black text above each bar in the plot represents the proportion of variance explained by that PC. Data source: USDA FoodData Central (Accessed 02/14/2022).\r\n\r\nLoadings\r\n\r\n\r\nCode\r\n\r\n#Loadings or rotations of first 5 PCs\r\nfood_pca2_table <- as.data.frame(food_pca2$rotation[,1:5])\r\n\r\n\r\n\r\n#Present as table\r\nfood_pca2_table %>% \r\n\r\n  #Add table caption\r\n  kable(caption = \"Loadings or rotations for the first four principal components (PC) for the principal component analysis for macronutrients, energy, fiber, and vitamins. Data source: USDA FoodData Central (Accessed 02/14/2022).\",\r\n        \r\n        #Round digits\r\n        digits = 2,\r\n        \r\n        #Align PCs to center\r\n        align = rep(\"c\", times = 5),\r\n        \r\n        #Change width of table\r\n        table.attr = \"style='width:80%;'\") %>% \r\n  \r\n  #kableExtra styling\r\n  #Not make table full width, hover rows\r\n  kable_styling(bootstrap_options = \"hover\") %>% \r\n  \r\n  #Bold row names\r\n  column_spec(1, bold = TRUE) %>% \r\n  \r\n  #Highlight specific cells for high negative and positive values\r\n  #Color text white if background is hightlighted\r\n\r\n  #PC1\r\n  column_spec(2, background = case_when(food_pca2_table$PC1 <= -0.25 ~ \"firebrick\", \r\n                                        food_pca2_table$PC1 >= 0.30 ~ \"darkgreen\",\r\n                                        TRUE ~ \" \"),\r\n              color = case_when(food_pca2_table$PC1 <= -0.25 ~ \"white\", \r\n                                food_pca2_table$PC1 >= 0.30 ~ \"white\",\r\n                                TRUE ~ \" \")) %>% \r\n  #PC2\r\n  column_spec(3, background = case_when(food_pca2_table$PC2 <= -0.25 ~ \"firebrick\", \r\n                                        food_pca2_table$PC2 >= 0.30 ~ \"darkgreen\",\r\n                                        TRUE ~ \" \"),\r\n              color = case_when(food_pca2_table$PC2 <= -0.25 ~ \"white\", \r\n                                food_pca2_table$PC2 >= 0.30 ~ \"white\",\r\n                                TRUE ~ \" \")) %>% \r\n  #PC3\r\n  column_spec(4, background = case_when(food_pca2_table$PC3 <= -0.25 ~ \"firebrick\", \r\n                                        food_pca2_table$PC3 >= 0.30 ~ \"darkgreen\",\r\n                                        TRUE ~ \" \"),\r\n              color = case_when(food_pca2_table$PC3 <= -0.25 ~ \"white\", \r\n                                food_pca2_table$PC3 >= 0.30 ~ \"white\",\r\n                                TRUE ~ \" \")) %>%\r\n  #PC4\r\n  column_spec(5, background = case_when(food_pca2_table$PC4 <= -0.25 ~ \"firebrick\", \r\n                                        food_pca2_table$PC4 >= 0.30 ~ \"darkgreen\",\r\n                                        TRUE ~ \" \"),\r\n              color = case_when(food_pca2_table$PC4 <= -0.25 ~ \"white\", \r\n                                food_pca2_table$PC4 >= 0.30 ~ \"white\",\r\n                                TRUE ~ \" \")) %>% \r\n  \r\n  #PC5\r\n  column_spec(6, background = case_when(food_pca2_table$PC5 <= -0.25 ~ \"firebrick\", \r\n                                        food_pca2_table$PC5 >= 0.30 ~ \"darkgreen\",\r\n                                        TRUE ~ \" \"),\r\n              color = case_when(food_pca2_table$PC5 <= -0.25 ~ \"white\", \r\n                                food_pca2_table$PC5 >= 0.30 ~ \"white\",\r\n                                TRUE ~ \" \"))\r\n\r\n\r\n\r\nTable 2: Loadings or rotations for the first four principal components (PC) for the principal component analysis for macronutrients, energy, fiber, and vitamins. Data source: USDA FoodData Central (Accessed 02/14/2022).\r\n\r\n\r\n\r\n\r\nPC1\r\n\r\n\r\nPC2\r\n\r\n\r\nPC3\r\n\r\n\r\nPC4\r\n\r\n\r\nPC5\r\n\r\n\r\nenergy_kcal\r\n\r\n\r\n-0.15\r\n\r\n\r\n0.56\r\n\r\n\r\n0.24\r\n\r\n\r\n0.00\r\n\r\n\r\n-0.12\r\n\r\n\r\nprotein_g\r\n\r\n\r\n0.43\r\n\r\n\r\n0.03\r\n\r\n\r\n0.02\r\n\r\n\r\n0.18\r\n\r\n\r\n-0.15\r\n\r\n\r\nfat_g\r\n\r\n\r\n-0.12\r\n\r\n\r\n0.63\r\n\r\n\r\n-0.02\r\n\r\n\r\n0.04\r\n\r\n\r\n0.02\r\n\r\n\r\ncarb_g\r\n\r\n\r\n-0.27\r\n\r\n\r\n-0.17\r\n\r\n\r\n0.49\r\n\r\n\r\n-0.14\r\n\r\n\r\n-0.17\r\n\r\n\r\nsugar_g\r\n\r\n\r\n-0.28\r\n\r\n\r\n-0.10\r\n\r\n\r\n0.25\r\n\r\n\r\n-0.29\r\n\r\n\r\n-0.39\r\n\r\n\r\nfiber_g\r\n\r\n\r\n-0.05\r\n\r\n\r\n-0.10\r\n\r\n\r\n0.47\r\n\r\n\r\n0.16\r\n\r\n\r\n0.21\r\n\r\n\r\nvit_a_mcg\r\n\r\n\r\n0.14\r\n\r\n\r\n0.12\r\n\r\n\r\n0.07\r\n\r\n\r\n-0.59\r\n\r\n\r\n0.20\r\n\r\n\r\nvit_b6_mg\r\n\r\n\r\n0.40\r\n\r\n\r\n0.07\r\n\r\n\r\n0.12\r\n\r\n\r\n0.20\r\n\r\n\r\n-0.13\r\n\r\n\r\nvit_b12_mcg\r\n\r\n\r\n0.33\r\n\r\n\r\n0.07\r\n\r\n\r\n0.00\r\n\r\n\r\n-0.51\r\n\r\n\r\n0.05\r\n\r\n\r\nvit_c_mg\r\n\r\n\r\n-0.04\r\n\r\n\r\n-0.07\r\n\r\n\r\n-0.02\r\n\r\n\r\n-0.05\r\n\r\n\r\n0.75\r\n\r\n\r\nvit_e_mg\r\n\r\n\r\n-0.08\r\n\r\n\r\n0.46\r\n\r\n\r\n0.04\r\n\r\n\r\n0.07\r\n\r\n\r\n0.15\r\n\r\n\r\nfolate_mcg\r\n\r\n\r\n0.09\r\n\r\n\r\n-0.03\r\n\r\n\r\n0.49\r\n\r\n\r\n0.14\r\n\r\n\r\n0.24\r\n\r\n\r\nniacin_mg\r\n\r\n\r\n0.43\r\n\r\n\r\n0.06\r\n\r\n\r\n0.13\r\n\r\n\r\n0.16\r\n\r\n\r\n-0.14\r\n\r\n\r\nriboflavin_mg\r\n\r\n\r\n0.33\r\n\r\n\r\n0.04\r\n\r\n\r\n0.18\r\n\r\n\r\n-0.34\r\n\r\n\r\n-0.07\r\n\r\n\r\nthiamin_mg\r\n\r\n\r\n0.13\r\n\r\n\r\n-0.01\r\n\r\n\r\n0.31\r\n\r\n\r\n0.15\r\n\r\n\r\n0.13\r\n\r\n\r\nThe first two PCs of the PCA that includes vitamins explain about 35.82% of the variance (Figure 4), while the first five PCs explain about 66.34% variance.\r\nComplementing what was shown in the biplot (Figure 3), the first PC has high positive loadings (\\(\\ge 0.30\\)) for protein and various vitamins (Table 2) but high negative loadings for sugar and carbohydrates (\\(\\le -0.25\\)), suggesting this PC may capture information about food groups that contain animal products such as beef and shellfish. The second PC has high positive loadings for energy, fat, and vitamin E, which represents the food group for fats and oils. The third PC has high positive loadings for carbohydrates, fiber, and some vitamins, which possibly represents the food group for cereals and grains. The fourth PC shows high negative loadings for sugar and vitamins A and B12 as well as riboflavin, suggesting that foods with high additive sugars. Finally, the fifth PC has high negative loading for sugar and high positive loading for vitamin C, indicating that this PC may carry information about fruits and fruit juices which may be sweet but have high levels of vitamin C.\r\nSummary\r\nIn conclusion, PCA allows us to reduce the high-dimensional dataset to visually explore correlations between variables and whether there are certain clusters of observations. From the PCA on minerals and vitamins on a selection of food groups, we found that:\r\nEven after scaling, macronutrients and micronutrients can be distinguished using biplots, and food groups can be categorized into 1) high energy and high fat, 2) high sugar and high carbohydrate, or 3) high nutrient content (vitamins or minerals)\r\nObservations that belong in similar food groups (e.g., beef products and shellfish) have similar levels of vitamins, minerals, calories, and nutrients\r\nFor both the mineral and vitamin PCA, the biplots and scree plots reveal that the first two PCs explain less than 90% of the variance in the dataset; future observations should combine both variables in the dataset and perform PCA on one, large high-dimensional dataset\r\nReferences\r\nData and Literature\r\nNational Institute of Health (NIH) National Institute on Aging (NIA). Know Your Food Groups. https://www.nia.nih.gov/health/know-your-food-groups. Content reviewed: April 29, 2019. Accessed 02/18/2022.\r\nUnited States Department of Agriculture (USDA). FoodData Central. https://fdc.nal.usda.gov/download-datasets.html. Accessed 02/14/2022.\r\nUnited States Department of Agriculture (USDA) Food and Nutrition Information Center. National Agricultural Library. https://www.nal.usda.gov/legacy/fnic/food-composition. Accessed 02/18/2022.\r\nR Libraries\r\nFirke, S. (2021). janitor: Simple Tools for Examining and Cleaning Dirty Data. R package version 2.1.0. https://CRAN.R-project.org/package=janitor.\r\nHorikoshi, M. & Tang, Y. (2016). ggfortify: Data Visualization Tools for Statistical Analysis Results. https://CRAN.R-project.org/package=ggfortify.\r\nMüller, K. (2020). here: A Simpler Way to Find Your Files. R package version 1.0.1. https://CRAN.R-project.org/package=here.\r\nNeuwirth, E. (2014). RColorBrewer: ColorBrewer Palettes. R package version 1.1-2. https://CRAN.R-project.org/package=RColorBrewer.\r\nWickham et al., (2019). Welcome to the tidyverse. Journal of Open Source Software, 4(43), 1686, https://doi.org/10.21105/joss.01686.\r\nZhu, H. (2021). kableExtra: Construct Complex Table with ‘kable’ and Pipe Syntax. R package version 1.3.4. https://CRAN.R-project.org/package=kableExtra.\r\n\r\n\r\n\r\n",
    "preview": "projects/pca_usda_food/pca_usda_food_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-03-08T21:44:47-08:00",
    "input_file": {}
  },
  {
    "path": "projects/logistic_regression_palmetto/",
    "title": "Binary Logistic Regression: Classifying Florida Palmetto Species",
    "description": "In this project, I explored Florida palmetto data through exploratory visualizations and used binary logistic regression to classify palmetto species.",
    "author": [
      {
        "name": "Shuying Yu",
        "url": {}
      }
    ],
    "date": "2022-02-11",
    "categories": [
      "Logistic Regression",
      "R"
    ],
    "contents": "\r\n\r\nContents\r\nIntroduction\r\nResearch Question\r\nData and Methods\r\nResults\r\nExploratory Data Visualizations\r\nBinary Logistic Regression Model\r\nModel Comparison Using AIC\r\nFinal Model Selection\r\nClassification Accuracy of Final Model\r\n\r\nSummary\r\nReferences\r\nData and Literature\r\nR Libraries\r\n\r\n\r\n\r\n\r\nCode\r\n\r\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE,\r\n                      fig.align = \"center\")\r\n\r\n#Attach libraries\r\nlibrary(tidyverse)\r\nlibrary(here)\r\nlibrary(broom)\r\nlibrary(AICcmodavg)\r\nlibrary(kableExtra)\r\nlibrary(ggtext)\r\nlibrary(patchwork)\r\n\r\n\r\n\r\nIntroduction\r\nIn this project, I used binary logistic regression to classify Florida palmetto species as either Serenoa repens or Sabal etonia using physical measurements of the plants. Exploratory data analysis was performed and two logistic regression models were built. Accuracy was used as a metric for which model was better in classifying palmetto species.\r\nResearch Question\r\nCan we correctly classify whether a palemtto species is either Serenoa repens or Sabal etonia? For binary logistic regression, we want to investigate whether the model can classify whether a palmetto belongs to species Serenoa repens or Sabal etonia using the variables plant height (cm), canopy length (cm), canopy width (cm), and number of green leaves. In other words, we want to investigate whether the model can significantly predict our outcome variable, palmetto species.\r\nNull hypothesis (\\(H_0\\)): The model does not significantly predict the log odds of species being equal to Serenoa repens. The \\(\\beta_j\\) coefficients are equal to zero for each \\(j\\text{th}\\) predictor variable.\r\nAlternative hypothesis (\\(H_1\\)): At least one of the predictors or explanatory variables significantly predicts the log odds of species being equal to Serenoa repens. At least one of the \\(\\beta_j\\) coefficients in the model is not equal to zero.\r\nData and Methods\r\nPalmetto plant species Serenoa repens and Sabal etonia were observed from the years 1981 - 2017 at the Archbold Biological Station in south-central Florida and made publicly available by Dr. Warren Abrahamson (Abrahamson, 2019). Seedlings were planted and survival, growth, and biomass of the two species of plants were measured. Maximum height (cm), widest length of the canopy (cm), widest width of the canopy (cm), and the number of green leaves were among the physical measurements of plant growth that were recorded.\r\nFollowing exploratory data visualizations, the relationship between species and other recorded measurements were investigated by binary logistic regression. 10-fold cross-validation was performed, and accuracy and AIC were used as metrics to compare two different models and choose the model with better performance. Sample size and proportion of species correctly classified by the final model are reported. All analyses were conducted in R version 4.1.1 and RStudio version 1.4.1717.\r\nResults\r\nExploratory Data Visualizations\r\n\r\n\r\nCode\r\n\r\n#Read in the data \r\npalmetto <- read_csv(here(\"_projects\", \"data\", \"palmetto.csv\"))\r\n\r\n\r\n#Clean the data\r\npalmetto <- palmetto %>% \r\n  \r\n  #Select relevant variables\r\n  select(height:green_lvs, species) %>% \r\n  \r\n  #Recode species vairable\r\n  #1 = Serenoa repens, 2 = Sabal etonia\r\n  mutate(species = case_when(species == 1 ~ \"Serenoa repens\",\r\n                             species == 2 ~ \"Sabal etonia\")) %>% \r\n  \r\n  #Change species as factor\r\n  mutate(species = as.factor(species)) %>% \r\n  \r\n  #Reame variables to add units\r\n  rename(height_cm = height,\r\n         length_cm = length,\r\n         width_cm = width,\r\n         green_leaves = green_lvs)\r\n\r\n\r\n\r\n\r\n\r\nCode\r\n\r\n### Plot 1: height and length marginal distributions\r\n\r\n#Define color palette\r\npalmetto_colors <- c(\"slateblue1\", \"skyblue1\") \r\n\r\n#Create scatterplot and marginal distributions\r\nggplot(data = palmetto, \r\n       aes(x = length_cm, y = height_cm, \r\n           color = species)) +\r\n  \r\n  #Define scatter\r\n  geom_point(alpha = 0.50, size = 2) + \r\n  \r\n  #Change colors\r\n  scale_colour_manual(values = palmetto_colors) +\r\n  \r\n  #Change theme\r\n  theme_minimal() +\r\n  \r\n  #Change x-axis and y-axis labels\r\n  #Change legend title\r\n  labs(x = \"Canopy Length (cm)\",\r\n       y = \"Height (cm)\",\r\n       color = \"Species\") +\r\n  \r\n  #Change legend position\r\n  theme(legend.position = c(0.8, 0.15),\r\n        \r\n        #Bold title of legend\r\n        legend.title = element_text(face = \"bold\"),\r\n        \r\n        #Bold x-axis and y-axis label text, change size\r\n        axis.title = element_text(face = \"bold\", size = 11))\r\n\r\n\r\n\r\n\r\nFigure 1. Canopy length (cm) plotted by plant height (cm) for each individual palmetto plant species, Sabal etonia (purple points) and Serenoa repens (blue points). Data source: Abrahamson, 2019.\r\n\r\n\r\n\r\nCode\r\n\r\n### Plot 2: Histogram of leaves by species\r\n\r\n#Get mean of leaves by species\r\npalmetto_leaves <-  palmetto %>% \r\n  select(species, green_leaves) %>% \r\n  group_by(species) %>% \r\n  summarize(avg_leaves = mean(green_leaves, na.rm = TRUE))\r\n\r\n\r\n#Bar plot\r\nggplot(data = palmetto, aes(x = green_leaves,\r\n                            fill = species)) +\r\n  \r\n  #Define histogram\r\n  #Fill with same colors and allow overlap\r\n  geom_histogram(alpha = 0.60, position = \"dodge\") +\r\n  \r\n  #Change colors\r\n  scale_color_manual(values = palmetto_colors) +\r\n  scale_fill_manual(values = palmetto_colors) +\r\n  \r\n  #Change theme\r\n  theme_minimal() +\r\n  \r\n  #Change x-axis and y-axis labels\r\n  labs(x = \"Number of Green Leaves\",\r\n       y = \"Count\",\r\n       fill = \"Species\") +\r\n  \r\n  #Change legend position inside plot\r\n  theme(legend.position = c(.80, .80),\r\n        \r\n        #Bold title\r\n        legend.title = element_text(face = \"bold\"),\r\n        \r\n        #Bold x-axis and y-axis label text, change size\r\n        axis.title = element_text(face = \"bold\", size = 11))\r\n\r\n\r\n\r\n\r\nFigure 2. Histogram plots show the frequency of the number of green leaves counted per plant for each palmetto plant species, Sabal etonia (purple bars) and Serenoa repens (blue bars). Data source: Abrahamson, 2019.\r\n\r\n\r\n\r\nCode\r\n\r\n### Plot 3: Check width of species\r\n\r\n#Beeswaram boxplot\r\nggplot(data = palmetto, aes(x = species,\r\n                            y = width_cm,\r\n                            fill = species)) +\r\n  \r\n  #Define violin plot\r\n  #Change color fill to species, remove legend\r\n  geom_violin(alpha = 0.5, show.legend = FALSE) +\r\n\r\n  \r\n  #Add median point, change size and color\r\n  #Remove legend\r\n  stat_summary(fun = median, geom = \"point\", \r\n               size = 3, color = \"black\",\r\n               show.legend = FALSE) +\r\n  \r\n  #Change x-axis and y-axis labels\r\n  labs(x = \"Palmetto Species \\n\",\r\n       y = \"Canopy Width (cm) \\n\") +\r\n  \r\n  #Use color palette to fill boxplot\r\n  scale_fill_manual(values = palmetto_colors) +\r\n  \r\n  #Use color palette to fill jitter points\r\n  scale_color_manual(values = palmetto_colors) +\r\n\r\n  #Change theme\r\n  theme_classic() +\r\n  \r\n  #Add break in species names\r\n  scale_x_discrete(labels = c(\"Sabal etonia\", \"Serenoa repens\")) +\r\n  \r\n  #Italicize latin names for species\r\n  theme(axis.text.x = element_text(face = \"italic\", size = 11),\r\n        \r\n        #Bold x-axis and y-axis label text, change size\r\n        axis.title = element_text(face = \"bold\", size = 11))\r\n\r\n\r\n\r\n\r\nFigure 3. Violin plots for the distribution of canopy width (cm) for each palmetto species, Sabal etonia (purple) and Serenoa repens (blue). The violin plot outlines illustrate the kernel probability density such that the width of the shaded area represents the proportion of the data located there. The black point within the violin plot indicates the median width for each species. Data source: Abrahamson, 2019.\r\n\r\nInitial exploration of the data reveals certain physical traits between the two palmetto species. Height between the two species appear similar, but the Serenoa repens plant species seem to have shorter canopy length (Figure 1). There is also a difference in the number of green leaves measured, with Serenoa repens plants having larger range and variance with an average of 7.5 green leaves counted (Figure 2). The majority of Sabal etonia plants have on average 4.02 green leaves, and the variance appears smaller. For the final exploratory plot, the canopy width was examined between the species and their respective width distribution and median width appear to be similar (Figure 3). Based on these plots, plant height and number of green leaves are the most likely to be helpful in classifying palmetto species correctly.\r\nBinary Logistic Regression Model\r\nWe will build two binary logistic regression models to determine the probability of a plant being either Serenoa repens or Sabal etonia based on several predictor variables.\r\nModel 1: Log odds of palmetto species being Serenoa repens using plant height, canopy length, canopy width, and number of green leaves as predictor variables\r\nModel 2: Log odds of palmetto species being Serenoa repens using plant height, canopy width, and number of green leaves as predictor variables\r\n\r\n\r\n\r\nCode\r\n\r\n########## Build the models ##########\r\n\r\n### Model 1\r\n\r\n#Define model with formula\r\nfx1 <- species ~ height_cm + length_cm + width_cm + green_leaves\r\n\r\n#Create model\r\n#Sabal etonia is reference\r\nmod1 <- glm(formula = fx1, data = palmetto,\r\n            family = \"binomial\")\r\n\r\n\r\n### Model 2\r\n\r\n#Define model with formula\r\nfx2 <- species ~ height_cm + width_cm + green_leaves\r\n\r\n#Create model\r\n#Sabal etonia is reference\r\nmod2 <- glm(formula = fx2, data = palmetto,\r\n            family = \"binomial\")\r\n\r\n\r\n\r\n########## K-fold cross-validation ##########\r\n\r\n### Define parameters\r\n\r\n#Set seed\r\nset.seed(244)\r\n\r\n#10 fold, k=10\r\nn_folds <- 10\r\n\r\n#Create vector whose length is same as number of rows in our df\r\nfold_vec <- rep(1:n_folds, length.out = nrow(palmetto))\r\n\r\n#Randomize\r\n#Assign new column the number from fold_vec (repeats of 1-10)\r\n#Each group of 10 gets assigned a number 1-10, to divide folds into 10\r\npalmetto_fold <- palmetto %>% \r\n  mutate(fold = sample(fold_vec, size = n()))\r\n\r\n\r\n### Prediction accuracy function\r\n\r\npred_acc <- function(x, y) {\r\n  accurate <- ifelse(x == y, 1, 0)\r\n  return(mean(accurate, na.rm = TRUE))\r\n}\r\n\r\n\r\n### Run cross-validation\r\n\r\n#Create empty dataframe \r\nresults_df <- data.frame()\r\n\r\n#Loop 10 folds for cross-validation\r\nfor(i in 1:n_folds){\r\n  \r\n  \r\n  #Create test and training sets\r\n  #90/10, train/test\r\n  kfold_test_df <- palmetto_fold %>% \r\n    filter(fold_vec == i)\r\n  kfold_train_df <- palmetto_fold %>% \r\n    filter(fold_vec != i)\r\n  \r\n  \r\n  #Train the 2 models on training set\r\n  kfold_model1 <- glm(formula = fx1, data = kfold_train_df,\r\n                      family = \"binomial\")\r\n  kfold_model2 <- glm(formula = fx2, data = kfold_train_df,\r\n                      family = \"binomial\")\r\n  \r\n  \r\n  #Test df\r\n  #Based on new model, use that to predict whether it is S.repens or not\r\n  kfold_pred <- kfold_test_df %>% \r\n    mutate(blr1 = predict(kfold_model1,\r\n                          kfold_test_df,\r\n                          type = \"response\"),\r\n           blr2 = predict(kfold_model2,\r\n                          kfold_test_df,\r\n                          type = \"response\")) %>% \r\n    \r\n    #Add a new column for predicted sepecies\r\n    mutate(pred1 = ifelse(blr1 > 0.50,\r\n                          \"Serenoa repens\", \"Sabal etonia\"),\r\n           pred2 = ifelse(blr2 > 0.50,\r\n                          \"Serenoa repens\", \"Sabal etonia\"))\r\n  \r\n  #Accuracy between true species and predicted species\r\n  #Use predict accuracy function\r\n  kfold_accuracy <- kfold_pred %>% \r\n    summarize(blr1_acc = pred_acc(species, pred1),\r\n              blr2_acc = pred_acc(species, pred2))\r\n  \r\n  #Combine accuracy to results df\r\n  results_df <- bind_rows(results_df,\r\n                          kfold_accuracy)\r\n  \r\n}\r\n\r\n########## Check mean accuracy of each model ##########\r\n\r\n#Mean accuracy\r\nacc_table <- results_df %>%\r\n  \r\n  #Get mean of accuracy\r\n  summarize(blr1_acc = mean(blr1_acc),\r\n            blr2_acc = mean(blr2_acc)) \r\n\r\n#Add row name\r\nrownames(acc_table) <- c(\"Mean Prediction Accuracy\")\r\n\r\n#Style in kable\r\nacc_table %>% \r\n  \r\n  #Change column names\r\n  kable(col.names = c(\"Model 1\", \"Model 2\"), \r\n        \r\n        caption = \"Average prediction accuracy of \r\n        palmetto species for Model 1 and Model 2 from 10-fold \r\n        cross-validation. Model 1 includes all predictors \r\n        (plant height, canopy width, canopy length, and \r\n        number of green leaves) while Model 2 excludes \r\n        canopy length from the model. \r\n        Data source: Abrahamson, 2019.\",\r\n  \r\n        #Align all cells/columns to center\r\n        align = c(rep(\"c\", times = 3)),\r\n        \r\n        #Round digits to 2\r\n        digits = 2,\r\n        \r\n        #Change width of table\r\n        table.attr = \"style='width:60%;'\") %>% \r\n\r\n   kable_styling(full_width = TRUE,\r\n                 position = \"center\")\r\n\r\n\r\n\r\nTable 1: Average prediction accuracy of palmetto species for Model 1 and Model 2 from 10-fold cross-validation. Model 1 includes all predictors (plant height, canopy width, canopy length, and number of green leaves) while Model 2 excludes canopy length from the model. Data source: Abrahamson, 2019.\r\n\r\n\r\n\r\n\r\nModel 1\r\n\r\n\r\nModel 2\r\n\r\n\r\nMean Prediction Accuracy\r\n\r\n\r\n0.91\r\n\r\n\r\n0.89\r\n\r\n\r\nWe perform k-fold cross-validation with \\(k = 10\\) folds for each model. Model 1 with all the predictors in the model has a higher mean accuracy (91.04%) in classifying palmetto species than Model 2 (89.31%) (Table 1).\r\nModel Comparison Using AIC\r\nWe can use the Akaike information criterion (AIC) as an additional metric to compare the fit of our binary logistic regression models. AIC is calculated as:\r\n\\[\\text{AIC}=2K−2ln(L)\\]\r\nwhere K is the number of model parameters (default is 2), and \\(ln(L)\\) is the log-likelihood of the model. The log-likelihood tells us how likely the model is given the data we use.\r\n\r\n\r\n\r\nCode\r\n\r\n########## AICc ##########\r\n\r\n#Compare AIC of model 1 and model 2\r\naic <- AIC(mod1, mod2)\r\n\r\n#Allows to compare 2 model values at once here\r\n#Gives K, delta AICc... lists best model first\r\naictable <- AICcmodavg::aictab(list(mod1, mod2))\r\n\r\n#Rename model names in column\r\naictable$Modnames <- c(\"Model 1\", \"Model 2\")\r\n\r\n########## Create finalized table ##########\r\n\r\naictable %>% \r\n  \r\n  #Use kable to make nice format\r\n  kable(col.names = c(\"Model Name\", \"*K*\",\r\n        \"AIC (corrected)\", \"Change in AIC (corrected)\", \r\n        \"Model Likelihood\", \"AIC (corrected) Weight\", \r\n        \"Log-Likelihood\", \"Cumulative Weight\"),\r\n        \r\n        #Add caption\r\n        caption = \"Statistics for the AIC table \r\n        between Model 1 and Model 2, which includes the \r\n        number of parameters in the model, the corrected AIC \r\n        value, the difference in AIC value between the best \r\n        model compared to the current model, proportion of \r\n        total predictive power found in the model (%), the \r\n        log-likelihood of the model, and finally the cumulative \r\n        sum of the AIC weights. Data source: Abrahamson, 2019.\",\r\n        \r\n        #Align all cells/columns to center\r\n        align = c(rep(\"c\", times = 8)),\r\n        \r\n        #Round digits to 2\r\n        digits = 2) %>% \r\n  \r\n  #Make full width\r\n  kable_styling(full_width = TRUE, position = \"center\") \r\n\r\n\r\n\r\nTable 2: Statistics for the AIC table between Model 1 and Model 2, which includes the number of parameters in the model, the corrected AIC value, the difference in AIC value between the best model compared to the current model, proportion of total predictive power found in the model (%), the log-likelihood of the model, and finally the cumulative sum of the AIC weights. Data source: Abrahamson, 2019.\r\n\r\n\r\nModel Name\r\n\r\n\r\nK\r\n\r\n\r\nAIC (corrected)\r\n\r\n\r\nChange in AIC (corrected)\r\n\r\n\r\nModel Likelihood\r\n\r\n\r\nAIC (corrected) Weight\r\n\r\n\r\nLog-Likelihood\r\n\r\n\r\nCumulative Weight\r\n\r\n\r\nModel 1\r\n\r\n\r\n5\r\n\r\n\r\n5194.57\r\n\r\n\r\n0.00\r\n\r\n\r\n1\r\n\r\n\r\n1\r\n\r\n\r\n-2592.28\r\n\r\n\r\n1\r\n\r\n\r\nModel 2\r\n\r\n\r\n4\r\n\r\n\r\n5987.48\r\n\r\n\r\n792.91\r\n\r\n\r\n0\r\n\r\n\r\n0\r\n\r\n\r\n-2989.74\r\n\r\n\r\n1\r\n\r\n\r\nWe used AIC model selection to distinguish among two possible models describing the relationship between the log odds of palmetto species being Serenoa repens using plant height, canopy length, canopy width, and number of green leaves as predictor variables. Here, Model 1 (K: 5, AIC: 5194.57) has a lower AIC value than Model 2 (K: 4, AIC: 5987.48) (Table 2). Thus, the better fitting model is Model 1, carrying majority of the cumulative model weight, and includes all the covariates with no interaction effects. The \\(\\Delta\\)AIC is 792.91, which is the difference in AIC score between the model being compared (Model 2) and the better performing model (Model 1).\r\nThus, according to our mean prediction accuracy and AIC measures, Model 1 with all four predictor variables is the better model. We will select this as the final model and train the model on the entire dataset.\r\nFinal Model Selection\r\n\r\n\r\nCode\r\n\r\n#Final model using all predictors\r\nblr_final <- glm(species ~ ., \r\n                 data = palmetto, \r\n                 family = \"binomial\")\r\n\r\n#Make into tidy format\r\nblr_final_tidy <- broom::tidy(blr_final)\r\n\r\n#Change row term names for kable\r\nblr_final_tidy_kable <- blr_final_tidy\r\nblr_final_tidy_kable$term <- c(\"(Intercept)\", \"Height (cm)\",\r\n                               \"Length (cm)\", \"Width (cm)\", \"Green Leaves\")\r\n\r\n#Change p-value so it writes \"< 0.001\" in kableExtra table\r\nblr_final_tidy_kable$p.value <- ifelse(blr_final_tidy_kable$p.value < 0.001,\r\n                                       paste(\"< 0.001\"),\r\n                                       paste(\"=\", blr_final_tidy_kable$p.value))\r\n\r\n\r\n#Use kableExtra to format into nice table\r\nblr_final_tidy_kable %>% \r\n  \r\n  #Change column and row names\r\n  kable(col.names = c(\"Predictor Variable\", \"Coefficient\",\r\n                      \"Standard Error\", \"*Z*-value\", \"*p*-value\"),\r\n        #Add caption\r\n        caption = \"Binary logistic regression results \r\n        for the log odds of palmetto species being \r\n        *Serenoa repens*. The four predictor variables \r\n        plant height (cm), canopy length (cm), canopy width \r\n        (cm), and number of green leaves are shown on the \r\n        left column and model summary statistics are on the \r\n        right columnns, reporting the $\\\\beta$ coefficients, \r\n        standard errors, *Z*-values, and *p*-values. \r\n        Data source: Abrahamson, 2019.\",\r\n        \r\n        #Align all cells/columns to center\r\n        align = c(rep(\"c\", times = 5)),\r\n        \r\n        #Round digits to 2\r\n        digits = 2) %>%\r\n  \r\n  #Make full width and add hover to rows\r\n  kable_styling(full_width = TRUE,\r\n                position = \"center\",\r\n                bootstrap_options = \"hover\")\r\n\r\n\r\n\r\nTable 3: Binary logistic regression results for the log odds of palmetto species being Serenoa repens. The four predictor variables plant height (cm), canopy length (cm), canopy width (cm), and number of green leaves are shown on the left column and model summary statistics are on the right columnns, reporting the \\(\\beta\\) coefficients, standard errors, Z-values, and p-values. Data source: Abrahamson, 2019.\r\n\r\n\r\nPredictor Variable\r\n\r\n\r\nCoefficient\r\n\r\n\r\nStandard Error\r\n\r\n\r\nZ-value\r\n\r\n\r\np-value\r\n\r\n\r\n(Intercept)\r\n\r\n\r\n-3.23\r\n\r\n\r\n0.14\r\n\r\n\r\n-22.71\r\n\r\n\r\n< 0.001\r\n\r\n\r\nHeight (cm)\r\n\r\n\r\n0.03\r\n\r\n\r\n0.00\r\n\r\n\r\n12.67\r\n\r\n\r\n< 0.001\r\n\r\n\r\nLength (cm)\r\n\r\n\r\n-0.05\r\n\r\n\r\n0.00\r\n\r\n\r\n-24.56\r\n\r\n\r\n< 0.001\r\n\r\n\r\nWidth (cm)\r\n\r\n\r\n-0.04\r\n\r\n\r\n0.00\r\n\r\n\r\n-18.78\r\n\r\n\r\n< 0.001\r\n\r\n\r\nGreen Leaves\r\n\r\n\r\n1.91\r\n\r\n\r\n0.04\r\n\r\n\r\n49.11\r\n\r\n\r\n< 0.001\r\n\r\n\r\nThe better performing and final model reveals that all \\(\\beta\\) coefficients are statistically significant (p < 0.001) (Table 3.). Thus, we would reject the null hypothesis that \\(\\beta_j\\) coefficients are equal to zero for each \\(j\\text{th}\\) predictor variable. The final model is written as:\r\n\\[\\small\r\n\\begin{aligned}\r\nln \\biggl( \\frac{P(\\widehat{\\text{species} = \\mathit{Serenoa \\ repens}})}{1 - P(\\widehat{\\text{species} = \\mathit{Serenoa \\ repens}})} \\biggr) = -3.23 + 0.03(\\text{Height}) - 0.05(\\text{Length}) - 0.04(\\text{Width}) + 1.91(\\operatorname{Green \\ Leaves})\r\n\\end{aligned}\\]\r\n\r\n\r\nCode\r\n\r\n########## Fit model to make predictions ##########\r\n\r\n##Take log odds and convert to probability\r\n#Get predicted probabilities of each plant being classified as Serenoa repens\r\nblr_fitted <- blr_final %>% \r\n  broom::augment(type.predict = \"response\") \r\n\r\n\r\n#Add column for what species the model predicted\r\nblr_fitted <- blr_fitted %>%\r\n  \r\n  #Create new column for predicted species\r\n  #Lower probability = Sabal etonia (< 50%)\r\n  #Higher probability = Serenoa repens (>= 50%)\r\n  mutate(species_predicted = case_when(.fitted >= 0.50 ~ \"Serenoa repens\",\r\n                                       .fitted < 0.50 ~ \"Sabal etonia\")) \r\n\r\n\r\n\r\n#Plot logistic regression fitted plots for green leaves\r\nggplot(data = blr_fitted, aes(x = green_leaves, \r\n                              y = .fitted)) + \r\n  \r\n  #Color points by species, change transparency and size\r\n  #Remove legend\r\n  geom_point(aes(color = species), alpha = 0.50, size = 2) +\r\n  \r\n  #Plot logistic regression curve, remove standard error\r\n  stat_smooth(method = \"glm\", se = FALSE, \r\n              method.args = list(family=binomial),\r\n              size = 1.3, color = \"grey12\") +\r\n  \r\n  #Change color\r\n  scale_color_manual(values = palmetto_colors) +\r\n  \r\n  #Change x-axis and y-axis labels\r\n  labs(x = \"Number of Green Leaves\",\r\n       y = \"Probability of Species being *Serenoa repens*\",\r\n       color = \"Species\") +\r\n  \r\n  #Change theme\r\n  theme_minimal() +\r\n  \r\n  #Add custom theme\r\n  #Make y-label part italic in rendered markdown\r\n  theme(axis.title.y = ggtext::element_markdown(),\r\n        \r\n        #Change position of legend\r\n        legend.position = c(.81, .30),\r\n        \r\n        #Bold title of legend\r\n        legend.title = element_text(face = \"bold\"),\r\n        \r\n        #Bold x-axis and y-axis label text, change size\r\n        axis.title = element_text(face = \"bold\", size = 11))\r\n\r\n\r\n\r\n\r\nFigure 4. Fitted logistic regression curve of the chosen model for the observed species, Serenoa repens (blue points) and Sabal etonia (purple points), with probabilities of a palmetto species being Serenoa repens and using number of green leaves as a predictor variable. Data source: Abrahamson, 2019.\r\n\r\nAll else being equal, the odds of a palmetto species being Serenoa repens increases by a multiplicative factor of \\(e^{0.03} = 1.03\\) for every 1 centimeter increase in plant height. The odds of a species being Serenoa repens decreases by a multiplicative factor of \\(e^{-0.05} = 0.95\\) for every 1 centimeter increases in canopy length. This means the the odds are about 5% less likely for the plant to be Serenoa repens. Similarly, every 1 centimeter increase in canopy width leads to a decrease in the odds of species being Serenoa repens by a multiplicative factor of \\(e^{-0.04} = 0.96\\). Finally, the odds of a species being Serenoa repens to increase by a multiplicative factor of \\(e^{1.91} = 6.75\\) for every additional count of green leaves on the plant. Probabilities for Serenoa repens are higher when observations report greater number of green leaves (Figure 4), otherwise probabilities are lower and likely to be Sabal etonia. This indicates that the number of green leaves on the plant is one of the best predictor variables for classifying palmetto species.\r\nClassification Accuracy of Final Model\r\n\r\n\r\nCode\r\n\r\n#Get total counts\r\nfinal_counts <- blr_fitted %>% \r\n  \r\n  #Use `across()` to obtain counts for variables that contian \"species\" name\r\n  count(across(contains(\"species\"))) \r\n\r\n\r\n\r\n########## Construct table for % classified ##########\r\n\r\n#Construct final table\r\nfinal_counts_table <- final_counts %>% \r\n  \r\n  #Make correct/incorrect label\r\n  mutate(classification_label = case_when(\r\n    (species == \"Sabal etonia\" & species_predicted == \"Sabal etonia\") ~ \"Correct\",\r\n    (species == \"Serenoa repens\" & species_predicted == \"Serenoa repens\") ~ \"Correct\",\r\n    (species == \"Sabal etonia\" & species_predicted == \"Serenoa repens\") ~ \"Incorrect\",\r\n    (species == \"Serenoa repens\" & species_predicted == \"Sabal etonia\") ~ \"Incorrect\"\r\n  )) %>% \r\n  \r\n  #Remove irrelevant variable\r\n  select(-species_predicted) %>% \r\n  \r\n  #Group by species and correctness\r\n  group_by(species, classification_label) %>% \r\n  \r\n  #Make wide format\r\n  pivot_wider(names_from = classification_label,\r\n              values_from = n) %>% \r\n  \r\n  #Make new column for percent correct\r\n  mutate(correct_pct = (Correct / (Correct + Incorrect)) * 100)\r\n\r\n\r\n\r\n########## Present table using kableExtra ##########\r\n\r\nfinal_counts_table %>% \r\n  \r\n  #Change column names\r\n  kable(col.names = c(\"Palmetto Species\", \"Sample Correctly Classified\",\r\n                      \"Sample Incorrectly Classified\", \"% Correctly Classified\"),\r\n        \r\n        caption = \"Sample size and percentage \r\n        of *Serenoa repens* and *Sabal etonia* palmettos \r\n        correctly or incorrectly classified by our binary \r\n        logistic regression model using four predictor \r\n        variables (plant height, canopy length, canopy width, \r\n        and number of green leaves). Threshold for classification \r\n        of *Serenoa repens* species was having a predicted \r\n        probability of 50% or greater. Data source: Abrahamson, 2019.\",\r\n        \r\n        #Align all cells/columns to center\r\n        align = c(\"l\", rep(\"c\", times = 3))) %>% \r\n  \r\n  #Not make full width\r\n  kable_styling(full_width = TRUE,\r\n                position = \"center\") %>% \r\n  \r\n  #Make species italic\r\n  column_spec(1, italic = TRUE, bold = TRUE)\r\n\r\n\r\n\r\nTable 4: Sample size and percentage of Serenoa repens and Sabal etonia palmettos correctly or incorrectly classified by our binary logistic regression model using four predictor variables (plant height, canopy length, canopy width, and number of green leaves). Threshold for classification of Serenoa repens species was having a predicted probability of 50% or greater. Data source: Abrahamson, 2019.\r\n\r\n\r\nPalmetto Species\r\n\r\n\r\nSample Correctly Classified\r\n\r\n\r\nSample Incorrectly Classified\r\n\r\n\r\n% Correctly Classified\r\n\r\n\r\nSabal etonia\r\n\r\n\r\n5701\r\n\r\n\r\n454\r\n\r\n\r\n92.62388\r\n\r\n\r\nSerenoa repens\r\n\r\n\r\n5548\r\n\r\n\r\n564\r\n\r\n\r\n90.77225\r\n\r\n\r\nFinally, we can evaluate how successfully this model would classify a plant as the correct species, using a 50% cutoff. The binary logistic regression model using four predictor variables (plant height, canopy length, canopy width, and number of green leaves) was successful over about 90% of the time in correctly classifying whether a palmetto species is either Serenoa repens or Sabal etonia.\r\nSummary\r\nIn conclusion, we have constructed and trained a binary logistic regression model that performs well in classifying palmetto species using physical attributes of the plant, which includes the plant height, canopy length, canopy width, and number of green leaves.\r\nVisualizing physical measurements between the two species show possible variables that would be informative for helping with model prediction\r\nModel metrics (prediction accuracy from k-fold cross-validation and AIC) reveal that the better performing model is one that includes all four predictor variables\r\nUsing a 50% probability threshold and the full dataset, the final model correctly classifies palmetto species at least 90% of the time\r\nReferences\r\nData and Literature\r\nAbrahamson, W.G. (2019). Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5\r\nR Libraries\r\nMazerolle, M.J. (2020) AICcmodavg: Model selection and multimodel inference based on (Q)AIC(c). R package version 2.3-1. https://cran.r-project.org/package=AICcmodavg.\r\nMüller, K. (2020). here: A Simpler Way to Find Your Files. R package version 1.0.1. https://CRAN.R-project.org/package=here.\r\nPedersen, T.L. (2020). patchwork: The Composer of Plots. R package version 1.1.1. https://CRAN.R-project.org/package=patchwork\r\nRobinson, D., Hayes, A., & Couch, S. (2021). broom: Convert Statistical Objects into Tidy Tibbles. R package version 0.7.9. https://CRAN.R-project.org/package=broom.\r\nWickham et al., (2019). Welcome to the tidyverse. Journal of Open Source Software, 4(43), 1686, https://doi.org/10.21105/joss.01686.\r\nWilke, C.O. (2020). ggtext: Improved Text Rendering Support for ‘ggplot2’. R package version 0.1.1. https://CRAN.R-project.org/package=ggtext\r\nZhu, H. (2021). kableExtra: Construct Complex Table with ‘kable’ and Pipe Syntax. R package version 1.3.4. https://CRAN.R-project.org/package=kableExtra.\r\n\r\n\r\n\r\n",
    "preview": "projects/logistic_regression_palmetto/logistic_regression_palmetto_files/figure-html5/fig1_explore-1.png",
    "last_modified": "2022-03-08T21:29:19-08:00",
    "input_file": {}
  },
  {
    "path": "projects/snag_behavior/",
    "title": "Behavioral and Spatial Data Analysis: Aging and Sex Differences in Spatial Navigation",
    "description": "In this project, I investigated age-related changes and sex differences in spatial navigation performance between young and midlife adults.",
    "author": [
      {
        "name": "Shuying Yu",
        "url": {}
      }
    ],
    "date": "2022-01-29",
    "categories": [],
    "contents": "\r\nThis project post is a work in progress.\r\nDistill is a publication format for scientific and technical writing, native to the web.\r\nLearn more about using Distill at https://rstudio.github.io/distill.\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2022-01-29T18:39:19-08:00",
    "input_file": {}
  },
  {
    "path": "projects/data_viz_mono_lake/",
    "title": "Data Visualization: Mono Lake Elevation Levels from 1850-2017",
    "description": "In this project, I created a data visualization of Mono Lake elevation levels and its major historical events using highly customized aesthetics in R.",
    "author": [
      {
        "name": "Shuying Yu",
        "url": {}
      }
    ],
    "date": "2021-11-28",
    "categories": [
      "Data Visualization",
      "R"
    ],
    "contents": "\r\n\r\nContents\r\nIntroduction\r\nData Visualization\r\nReferences\r\nData and Literature\r\nR Libraries\r\n\r\n\r\n\r\n\r\nCode\r\n\r\nknitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE,\r\n                      fig.align = \"center\")\r\n\r\n#Attach packages\r\nlibrary(tidyverse)\r\nlibrary(here)\r\nlibrary(janitor)\r\n\r\n\r\n\r\nIntroduction\r\nMono Lake is a terminal saline lake in Lee Vining, California, northeast of Yosemite National Park in the Pamidu Toiyabe (Sierra Nevada), and is home to the Kootzaduka’a (or Kutzadika’a) Tribe.\r\nData Visualization\r\n\r\n\r\nCode\r\n\r\n########## Read in the data \r\n\r\n#Skip first 4 lines, 5th line is header\r\nmono_lake <- read_csv(here(\"_projects\", \"data\", \"mono_lake_annual_levels.csv\"),\r\n                      skip = 5)\r\n\r\n#Check data\r\n#head(mono_lake)\r\n\r\n\r\n\r\n########## Clean data\r\n\r\nmono_lake <- mono_lake %>% \r\n  \r\n  #Convert to lower snake case\r\n  clean_names() %>% \r\n  \r\n  #Select only year and lake level above sea level\r\n  select(year, lake_level_feet_above_sea_level) \r\n\r\n#Check data\r\n#head(mono_lake)\r\n\r\n\r\n\r\n########## Plotting\r\n\r\n#Line plot of lake elevation levels over time in years\r\nggplot(data = mono_lake, aes(x = year,\r\n                             y = lake_level_feet_above_sea_level)) +\r\n  \r\n  #Define line plot\r\n  #Change size and color of line\r\n  geom_line(size = 1.15, color = \"aquamarine4\") +\r\n  \r\n  \r\n  \r\n  ########## Limits\r\n  \r\n  theme_minimal() +\r\n  \r\n  #Change x-axis scale\r\n  scale_x_continuous(breaks = seq(1850, 2017, by = 20)) +\r\n  \r\n  #Change y-axis scale\r\n  scale_y_continuous(breaks = seq(6350, 6440, by = 10)) +\r\n  \r\n  #Focus plot area on limits and allow text outside margins\r\n  coord_cartesian(xlim = c(1850,2017),\r\n                  ylim = c(6350, 6440), clip = \"off\") +\r\n  \r\n  \r\n  ########## Add horizontal lines: ELEVATION (Y-AXIS)\r\n  \r\n  #6392 ft: standard elevation set by State Water Board Decision 1631 in 1994\r\n  # geom_segment(aes(x = 1994.5, y = 6392,\r\n  #                  xend = Inf, yend = 6392),\r\n  #              color = \"lightsteelblue3\", size = 1.3) +\r\n  \r\n  #6377 ft: Land bridges emerge between the mainland and islands\r\n  geom_segment(aes(x = 1844, y = 6377,\r\n                   xend = Inf, yend = 6377),\r\n               color = \"dodgerblue3\", size = 1.3, linetype = \"dashed\") +\r\n\r\n  #6360 ft: Decrease in availability of brine shrimp for food (salinity at 120 g/L)\r\n  geom_segment(aes(x = 1844, y = 6360,\r\n                   xend = Inf, yend = 6360),\r\n               color = \"darkturquoise\", size = 1.3, linetype = \"dotdash\") +\r\n  \r\n  #6350 ft: Impacts on gulls due to decrease of food and when salinities above 150 g/L\r\n  geom_segment(aes(x = 1844, y = 6350,\r\n                   xend = Inf, yend = 6350),\r\n               color = \"lightblue2\", size = 1.3, linetype = \"dotted\") +\r\n  \r\n\r\n  \r\n  \r\n  ########## Shading\r\n  \r\n  #Shade area under 6350 ft\r\n  #Give geom_rect a single row data object to ensure only one rectangle is drawn\r\n  # geom_rect(data = mono_lake[1,],\r\n  #           aes(xmin = 1850, xmax = 2017, ymin = -Inf, ymax = 6350), \r\n  #           fill = \"lightblue2\", alpha = 0.2) +\r\n  \r\n  \r\n  \r\n  ########## Text\r\n\r\n  ##### 6392 text\r\n  # annotate(geom = \"text\", x = 2030, y = 6392, \r\n  #          label = expression(bold(\"6,392 feet:\")), \r\n  #                   hjust = 0, vjust = 0.5, size = 3) +\r\n  # annotate(geom = \"text\", x = 2030, y = 6389, \r\n  #          label = \"standard elevation\", \r\n  #                   hjust = 0, vjust = 0.5, size = 3) +\r\n\r\n  ##### 6377 text\r\n  annotate(geom = \"text\", x = 2030, y = 6377, \r\n           label = expression(bold(\"6,377 feet:\")), \r\n                    hjust = 0, vjust = 0.5, size = 3) +\r\n  annotate(geom = \"text\", x = 2030, y = 6374, \r\n           label = \"land bridges form\", \r\n                    hjust = 0, vjust = 0.5, size = 3) +\r\n\r\n  ##### 6360 text\r\n  annotate(geom = \"text\", x = 2030, y = 6360, \r\n           label = expression(bold(\"6,360 feet:\")), \r\n                    hjust = 0, vjust = 0.5, size = 3) +\r\n  annotate(geom = \"text\", x = 2030, y = 6357, \r\n           label = \"salinity at 120 g/L\", \r\n                    hjust = 0, vjust = 0.5, size = 3) +\r\n  \r\n  ##### 6350 text\r\n  annotate(geom = \"text\", x = 2030, y = 6350, \r\n           label = expression(bold(\"6,350 feet:\")), \r\n                    hjust = 0, vjust = 0.5, size = 3) +\r\n  annotate(geom = \"text\", x = 2030, y = 6347, \r\n           label = \"salinity at 150 g/L\", \r\n                    hjust = 0, vjust = 0.5, size = 3) +\r\n  \r\n  \r\n  \r\n  ########## Add vertical lines: YEAR (X-AXIS)\r\n  \r\n  ##### 1941: LA DWP begins diverting water from lake\r\n  \r\n  ##### 1941 point\r\n  #Point\r\n  geom_point(aes(x = 1941, y = 6417.5), color = \"darkorange1\", size = 3.5) +\r\n  \r\n  ##### 1941 arrow\r\n  geom_segment(x = 1941, y = 6420, xend = 1941, yend = 6425,\r\n               arrow = arrow(length = unit(2.5, \"mm\")), ends = \"first\") +\r\n  \r\n  ##### 1941 text\r\n  annotate(geom = \"text\", x = 1927, y = 6433, \r\n           label = expression(bold(\"1941:\")),\r\n                    hjust = 0, size = 3) +\r\n  annotate(geom = \"text\", x = 1940, y = 6433,\r\n           label = \"L.A. DWP diverts water \\nfrom tributary streams\",\r\n           hjust = 0, vjust = 0.85, size = 3) +\r\n  \r\n  \r\n  \r\n  #####1976: First comprehensive ecological study of Mono Lake by UCD and Stanford\r\n  \r\n  ##### 1976 point\r\n  geom_point(aes(x = 1976, y = 6378.60), color = \"darkorange1\", size = 3.5) +\r\n  \r\n  ##### 1976 arrow\r\n  geom_segment(x = 1976, y = 6383, xend = 1976, yend = 6410,\r\n               arrow = arrow(length = unit(2.5, \"mm\")), ends = \"first\") +\r\n  \r\n  ##### 1976 text\r\n  annotate(geom = \"text\", x = 1962, y = 6418, \r\n           label = expression(bold(\"1976:\")),\r\n                    hjust = 0, size = 3) +\r\n  annotate(geom = \"text\", x = 1975, y = 6418,\r\n           label = \"First comprehensive ecological \\nstudy of Mono Lake\",\r\n           hjust = 0, vjust = 0.85, size = 3) +\r\n  \r\n  \r\n  \r\n  \r\n  ##### 1994: State Water Board Decision 1631, levels set at 6392 feet to protect Mono Lake’s public trust values\r\n  \r\n  ##### 1994 point\r\n  geom_point(aes(x = 1994, y = 6374.60), color = \"darkorange1\", size = 3.5) +\r\n  \r\n  ##### 1994 arrow\r\n  geom_segment(x = 1994, y = 6380, xend = 1994, yend = 6395,\r\n               arrow = arrow(length = unit(2.5, \"mm\")), ends = \"first\") +\r\n  \r\n  ##### 1994 text\r\n  annotate(geom = \"text\", x = 1980, y = 6403, \r\n           label = expression(bold(\"1994:\")),\r\n                    hjust = 0, size = 3) +\r\n  annotate(geom = \"text\", x = 1993, y = 6403,\r\n           label = \"State Water Board \\nDecision 1631\",\r\n           hjust = 0, vjust = 0.85, size = 3) +\r\n  \r\n  \r\n\r\n  \r\n  ########## Theme\r\n\r\n  #Change x-axis and y-axis labels\r\n  labs(x = \"\\nYear\",\r\n       y = \"Mono Lake Elevation Levels \\n(feet above sea level)\\n\") +\r\n  \r\n  \r\n  #Customize theme of plot\r\n  #Bold and increase font of x-axis and y-axis labels\r\n  theme(axis.title.x = element_text(size = 12, face = \"bold\"),\r\n        axis.title.y = element_text(size = 12, face = \"bold\"),\r\n        \r\n        #Increase x-tick and y-tick text\r\n        axis.text.x = element_text(size = 10),\r\n        axis.text.y = element_text(size = 10),\r\n        \r\n        #Color x-axis and y-axis\r\n        axis.line.x = element_line(color = \"grey50\"),\r\n\r\n        #Increase margins: theme_minimal()$plot.margin\r\n        #Top, right, bottom, left\r\n        plot.margin = unit(c(0.2, 3, 0.2, 0.2), \"cm\")) \r\n\r\n\r\n\r\n\r\n\r\nFigure 1. Timeline of major historical events and legal decisions that have impacted Mono Lake elevation levels (feet above sea level) from the years 1850 - 2017. Text above Mono Lake elevation levels (green solid line) describes specific events that took place at certain years (orange points) and text to the right of the plot margin describes specific changes on the Mono Lake ecosystems at critical levels of elevation. Mono Lake elevation levels began to decline in 1941 when the Los Angeles (L.A.) Department of Water & Power (DWP) diverted water from the lake to meet the growing water demands of L.A. When elevation levels dropped to 6,377 feet (dark blue dashed line), land bridges emerged between the mainland and islands, which allowed predators to access major bird nesting sites. In 1976, the first comprehensive ecological study conducted by students at UC Davis and Stanford discovered that water diversions change lake salinity levels. At 6,360 feet (turquoise dot-dash line), brine shrimp and brine flies, which are main food sources for aquatic birds at Mono Lake, are adversely affected. At 6,350 feet (light blue dotted line), impacts become acute. In 1994, after a series of successful lawsuits charged by the Mono Lake Committee against DWP’s water diversions, the State Water Board issued Decision 1631, which set a lake level of 6,392 feet to protect Mono Lake’s public trust values, required permanent streamflows for Mono Basin streams, and ordered DWP to restore streams and waterfowl habitat damaged as a result of past diversions. Data source: Mono Basin Clearinghouse.\r\nReferences\r\nData and Literature\r\nMono Basin Clearinghouse: Building a Digital Library for Better Resource Management. Accessed 11/20/2021. https://www.monobasinresearch.org/.\r\nR Libraries\r\nFirke, S. (2021). janitor: Simple Tools for Examining and Cleaning Dirty Data. R package version 2.1.0. https://CRAN.R-project.org/package=janitor.\r\nMüller, K. (2020). here: A Simpler Way to Find Your Files. R package version 1.0.1. https://CRAN.R-project.org/package=here.\r\nWickham et al., (2019). Welcome to the tidyverse. Journal of Open Source Software, 4(43), 1686, https://doi.org/10.21105/joss.01686.\r\n\r\n\r\n\r\n",
    "preview": "projects/data_viz_mono_lake/data_viz_mono_lake_files/figure-html5/data-viz-1.png",
    "last_modified": "2022-03-08T21:26:35-08:00",
    "input_file": {}
  }
]
